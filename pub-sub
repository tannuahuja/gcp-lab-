pprase go through this lab 
I think this lab is useful for you

lab name: Build a Resilient, Asynchronous System with Cloud Run and Pub/Sub
 

link : https://www.cloudskillsboost.google/games/5924/labs/37659 
 
